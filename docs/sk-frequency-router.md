# SK Frequency Router

This document explains the Semantic Kernel-based Frequency Router implementation, which was generated by the SK Evolution Engine as an improvement to the cognitive architecture.

## Overview

The SK Frequency Router is a component that intelligently routes tasks to the appropriate cognitive frequency based on semantic analysis rather than simple keyword matching. It leverages Semantic Kernel to understand the context, urgency, complexity, and potential impact of a goal.

## Comparison: Old vs New Approach

| Feature | Old Approach (Keyword-based) | New Approach (SK-based) |
|---------|------------------------------|-------------------------|
| **Decision mechanism** | Keyword matching | Semantic understanding |
| **Context awareness** | Limited to specific keywords | Full contextual analysis |
| **Adaptability** | Fixed keyword sets | Adapts to new scenarios |
| **Nuance** | Binary keyword matching | Understands degrees and nuances |
| **Fallback mechanism** | Default to Analysis frequency | Provides next best alternative |
| **Economic evaluation** | Separate component | Integrated in the router |
| **Performance tracking** | Manual logging | Automated monitoring |
| **Prompt quality** | N/A | Enhanced, detailed prompts |
| **Benchmarking** | Not available | Comprehensive comparison |
| **Visualization** | Not available | Data-driven insights |
| **Dashboard** | Not available | Interactive HTML reports |

## Implementation Details

The implementation consists of four main components:

### 1. SK Frequency Router

The core router component with two primary methods:

- **DetermineFrequencyAsync**
   - Takes a goal and optional context
   - Uses SK to analyze the goal semantically
   - Returns the most appropriate frequency and its configuration

- **CalculateEconomicValueAsync**
   - Evaluates the economic value of processing a goal at a specific frequency
   - Returns a score from 0-100 representing the value

### 2. SK Frequency Router Prompts

A specialized component providing optimized prompts for the router:

- **FrequencyDeterminationPrompt**
   - Detailed guidance for frequency selection
   - Includes examples, considerations, and clear instructions
   - Enhances accuracy and consistency of routing decisions

- **EconomicValuePrompt**
   - Detailed guidance for economic value calculation
   - Includes value ranges for different scenarios
   - Ensures more accurate and consistent economic assessments

- **SampleGoals**
   - Provides a set of sample goals for each frequency
   - Used for testing, training, and benchmarking

### 3. SK Frequency Router Monitor

A monitoring component that tracks router performance:

- **RecordDecision**
   - Records routing decisions and their outcomes
   - Captures goal, context, frequency, economic value, success, and execution time

- **GenerateReport**
   - Analyzes routing decisions to evaluate performance
   - Provides insights on frequency distribution, success rates, and execution times

- **SaveLog/LoadLog**
   - Persists routing decisions to enable long-term analysis
   - Supports continuous improvement of the router

### 4. Integration with Orchestrator

The CognitiveFrequencyOrchestrator has been updated to:

1. Initialize instances of both SkFrequencyRouter and SkFrequencyRouterMonitor
2. Use the router when processing goals (when enabled)
3. Determine both frequency and economic value using the router
4. Record routing decisions and outcomes in the monitor
5. Generate performance reports to evaluate router effectiveness

## Enhanced Prompts

The router uses carefully crafted prompts to guide the Semantic Kernel:

### Frequency Determination Prompt

- Provides detailed descriptions of each frequency
- Includes examples of appropriate goals for each frequency
- Lists specific considerations for determining the appropriate frequency
- Ensures clear, consistent output format

### Economic Value Prompt

- Explains what economic value represents
- Provides clear guidelines for value ranges by frequency
- Lists factors to consider in economic evaluation
- Ensures output is a consistent numeric score

## Performance Monitoring

The SK Frequency Router Monitor tracks the following metrics:

- **Frequency distribution**: Which frequencies are selected most often
- **Success rates**: How often each frequency leads to successful outcomes
- **Economic values**: Average economic value by frequency
- **Execution times**: How long each frequency takes to process

These metrics enable continuous evaluation and improvement of the router, ensuring it routes tasks to the most appropriate frequency over time.

## Benchmarking

The system includes a benchmarking tool to compare the SK-based router with the keyword-based approach:

```bash
./benchmark-frequency-router.sh [test_cases]
```

The benchmark:
- Runs both routers on the same set of test cases
- Measures processing time, frequency distribution, and economic values
- Calculates agreement rate between the routers
- Provides sample disagreements for analysis
- Saves detailed results for further study

## Data Visualization

The system includes visualization tools to analyze benchmark results:

```bash
./run-benchmark-and-visualize.sh [test_cases]
```

This script:
1. Runs the benchmark with the specified number of test cases
2. Processes the benchmark results
3. Generates visualizations including:
   - Frequency distribution chart
   - Economic value distribution by frequency
   - Processing time analysis
   - Performance summary

The visualizations provide:
- Clear insights into router performance
- Comparative analysis between approaches
- Distribution patterns across frequencies
- Economic value assessments

All visualizations are saved to a timestamped directory for easy reference and comparison over time.

## Interactive HTML Dashboard

The system includes an advanced interactive HTML dashboard for comprehensive visualization and analysis:

```bash
python generate-dashboard.py [benchmark_results.json] [output_file.html]
```

The dashboard includes:

1. **Key Metrics Overview**:
   - Total routing decisions
   - Average economic value
   - Average processing time
   - Success rate

2. **Interactive Charts**:
   - Frequency distribution
   - Economic value by frequency
   - Processing time by frequency
   - Success rate by frequency

3. **Detailed Analysis**:
   - Frequency distribution with percentage bars
   - Sample routing decisions table
   - Raw decision data

The dashboard is automatically generated when running the benchmark visualization script and provides a comprehensive view of the router's performance in an easy-to-share HTML format.

## Benefits

- **More accurate routing**: Tasks are routed to the most appropriate frequency based on their actual meaning rather than keywords
- **Better economic efficiency**: Economic value is calculated with more context
- **Reduced maintenance**: No need to maintain keyword lists
- **Greater adaptability**: Can understand new types of goals without updates
- **Improved nuance**: Understands degrees of urgency, complexity, etc.
- **Performance insights**: Tracks routing decisions to enable data-driven improvements
- **Benchmarking capabilities**: Provides comparative analysis against the previous approach
- **Visual analytics**: Generates charts and graphs for intuitive performance analysis
- **Interactive reporting**: Creates shareable HTML dashboards for comprehensive analysis

## Testing and Validation

The system includes a comprehensive test suite:

1. **Basic test**: Tests the router with a set of predefined goals
2. **Comprehensive test**: Tests with a wider range of scenarios across all frequencies
3. **Performance report**: Generates a detailed report of router performance
4. **Benchmark comparison**: Compares against the keyword-based approach
5. **Data visualization**: Provides visual insights into performance metrics
6. **Interactive dashboard**: Creates a comprehensive HTML report of all metrics

Run the tests using:

```bash
./run-sk-frequency-router-test.sh
```

Run the benchmark using:

```bash
./benchmark-frequency-router.sh [number_of_test_cases]
```

Run the benchmark with visualization:

```bash
./run-benchmark-and-visualize.sh [number_of_test_cases]
```

Generate a dashboard directly:

```bash
python generate-dashboard.py [benchmark_results.json] [output_file.html]
```

## Future Improvements

1. **Adaptive learning**: Train the router on past decisions to improve over time
2. **Personalization**: Consider user preferences and history
3. **Multi-context awareness**: Include project, team, and organizational context
4. **Confidence scores**: Provide confidence levels for routing decisions
5. **Dynamic thresholds**: Adjust frequency thresholds based on system load
6. **Anomaly detection**: Identify unusual routing patterns or poor performance
7. **Visualization dashboard**: Create a real-time dashboard of router performance
8. **Pre-trained models**: Fine-tune models specifically for frequency routing
9. **A/B testing framework**: Systematically compare different routing strategies
10. **Integration with monitoring systems**: Connect with broader system metrics
11. **Real-time analytics**: Live monitoring of routing decisions and performance
12. **Predictive modeling**: Forecast future routing patterns and resource needs 